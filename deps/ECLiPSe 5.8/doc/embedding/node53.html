<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Remote Peer Queues</TITLE>
<META NAME="description" CONTENT="Remote Peer Queues">
<META NAME="keywords" CONTENT="embroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="embroot.css">
<LINK REL="next" HREF="node54.html">
<LINK REL="previous" HREF="node52.html">
<LINK REL="up" HREF="node49.html">
<LINK REL="next" HREF="node54.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html1528"
 HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html1524"
 HREF="node49.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html1518"
 HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html1526"
 HREF="node76.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1529"
 HREF="node54.html">Control Messages</A>
<B> Up:</B> <A NAME="tex2html1525"
 HREF="node49.html">The Remote Interface Protocol</A>
<B> Previous:</B> <A NAME="tex2html1519"
 HREF="node52.html">Attachment</A>
 &nbsp <B>  <A NAME="tex2html1527"
 HREF="node76.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1530"
 HREF="node53.html#SECTION001041000000000000000">Synchronous peer queues</A>
<LI><A NAME="tex2html1531"
 HREF="node53.html#SECTION001042000000000000000">Asynchronous peer queues</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION001040000000000000000">
Remote Peer Queues</A>
</H1>

<P>
As discussed in section&nbsp;<A HREF="node51.html#remoteprotobasic">10.2</A>, peer queues can be formed
interactively during an attachment between the two sides. The protocol
provides for the creation and closing of these queues on both sides. 

<P>
The handling of data on these queues are performed by <I>data handlers</I>,
routines which either provide data to the queue or consume data from the
queue. They are triggered by the appropriate control messages, so that a
data consumer handler would consume data arriving on a queue, and a data
provider handler would send data onto a queue (which would be consumed on
the other side). These data handlers can be user defined. 

<P>
The programmer for the remote side needs to provide the remote side of the
interface to the peer queue. 

<P>

<H2><A NAME="SECTION001041000000000000000">
Synchronous peer queues</A>
</H2>

<P>
The implementation of a synchronous peer queue on the ECLiPSe side is
shown in figure&nbsp;<A HREF="node53.html#syncpeer">10.2</A>. There is an in-memory buffer, which is

<P></P>
<DIV ALIGN="CENTER"><A NAME="syncpeer"></A><A NAME="7139"></A>
<TABLE>
<CAPTION><STRONG>Figure:</STRONG>
ECLiPSe implementation of remote synchronous peer queue</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
</DIV><!-- MATH: $\includegraphics{syncpeer.ps}$ -->
<IMG
 WIDTH="666" HEIGHT="145" ALIGN="BOTTOM" BORDER="0"
 SRC="img4.gif"
 ALT="\includegraphics{syncpeer.ps}">
<DIV ALIGN="CENTER">
</DIV></TD></TR>
</TABLE>
</DIV><P></P>
implemented as a memory queue in ECLiPSe (i.e. <TT>queue("")</TT> option
for <A NAME="tex2html423"
 HREF="../bips/kernel/iostream/open-3.html">open/3</A><A NAME="7399"></A>). Associated with the memory queue is the actual socket
stream to the remote side.
The memory queue is the queue that the user sees on the ECLiPSe
side, with name <I>Name</I> and a unique integer id <I>Queue</I>, which is
the stream id for the memory queue. The id is used by both sides to identify
the queue, as it is unique (a symbolic name can always be reassigned), and
is used in the control messages. To conform to normal ECLiPSe streams,
these queues appear uni-directional to the user, i.e. data can be either
written to or read from the queue. The direction is <I>fromec</I> if the
direction of the data is from ECLiPSe to the remote side (i.e. 
ECLiPSe can output to the queue), and <I>toec</I>
if the direction is from the remote side to ECLiPSe (i.e. ECLiPSe
can read from the queue). The user perform normal I/O operations on the
memory queue, and the protocol ensures that the data is transferred
correctly to the remote side without blocking.

<P>
The socket stream is largely hidden from the user on the ECLiPSe side,
with data automatically transferred between it and the buffer. The buffer
is needed to ensure that when data is transferred between the two sides,
the I/O operation is synchronised (the data is being read on one end of the
socket while it is being written at the other), so no blocking will occur.
When a side needs to initiate an I/O operation with the other side (either
to write data to or read data from the other side via the socket stream), it must have control
(otherwise it would not be in a position to initiate an action). Before
performing the I/O operation, a control message is sent to the other side to
allow it to prepare to read the data before the I/O operation is actually
initiated. The memory queue thus serves to buffer the data before it is
transferred to the socket stream.

<P>
The socket stream must be connected to the remote side before it could be
used. Control messages are used also to synchronise the connection of
the socket. The protocol does not specify if a buffer is needed on the
remote side, this depends on the facilities available in the language used
for the remote side.

<P>
For a particular synchronous queue, a data handler can only be defined on
one side of the queue, but not both.

<H2><A NAME="SECTION001042000000000000000">
Asynchronous peer queues</A>
</H2>

<P>
I/O operations on these queues do not need to be controlled by the remote
protocol, but their creation and closing is controlled by the remote
protocol, so that the remote interface can keep track of these queues.
These are implemented as raw socket streams on the ECLiPSe
side, with I/O operations performed directly on the socket. The Name and
Queue id for the stream is thus those for the ECLiPSe socket stream. It
is the responsibility of the user to ensure that I/O operations do not
block on these queues. They are provided to allow asynchronous transfer of
data (e.g. from ECLiPSe side to the remote side without handing over
control), and also they allow more efficient transfer of data.  

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html1528"
 HREF="node54.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html1524"
 HREF="node49.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html1518"
 HREF="node52.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html1526"
 HREF="node76.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1529"
 HREF="node54.html">Control Messages</A>
<B> Up:</B> <A NAME="tex2html1525"
 HREF="node49.html">The Remote Interface Protocol</A>
<B> Previous:</B> <A NAME="tex2html1519"
 HREF="node52.html">Attachment</A>
 &nbsp <B>  <A NAME="tex2html1527"
 HREF="node76.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
