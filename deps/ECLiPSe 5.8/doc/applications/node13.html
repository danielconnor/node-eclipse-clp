<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Documentation</TITLE>
<META NAME="description" CONTENT="Documentation">
<META NAME="keywords" CONTENT="tutorial">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="tutorial.css">
<LINK REL="previous" HREF="node12.html">
<LINK REL="up" HREF="node6.html">
<LINK REL="next" HREF="node14.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html532"
 HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html526"
 HREF="node6.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html522"
 HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html528"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A> 
<A NAME="tex2html530"
 HREF="node78.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html533"
 HREF="node14.html">Data Structures</A>
<B> Up:</B> <A NAME="tex2html527"
 HREF="node6.html">High Level Design</A>
<B> Previous:</B> <A NAME="tex2html523"
 HREF="node12.html">Naming schemes</A>
 &nbsp <B>  <A NAME="tex2html529"
 HREF="node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html531"
 HREF="node78.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html534"
 HREF="node13.html#SECTION00371000000000000000">Comment directive</A>
<LI><A NAME="tex2html535"
 HREF="node13.html#SECTION00372000000000000000">Documenting all interfaces</A>
<LI><A NAME="tex2html536"
 HREF="node13.html#SECTION00373000000000000000">Mode declaration</A>
<LI><A NAME="tex2html537"
 HREF="node13.html#SECTION00374000000000000000">Documentation query</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00370000000000000000">
Documentation</A>
</H1>
A program that is not documented is not usable. It is very hard to deduce the intention of a program piece just from the implementation, but even a few sentences of explanation can simplify this task dramatically. On the other hand, it is imperative that the documentation and the implementation are consistent. In ECLiPSe we use in-line <I>comment</I> <A NAME="307"></A>directives to integrate the documentation with the program code. This makes it much easier to keep the documentation up to date than with a separate description file.  

<P>

<H2><A NAME="SECTION00371000000000000000">
Comment directive</A>
</H2>
The <I>comment</I> directives are placed in the source code together with other parts of the program. The ECLiPSe system contains some library predicates which extract the comment directives and build a set of interrelated HTML <A NAME="310"></A>pages for the documentation. The same system is used to generate the reference manual <A NAME="311"></A>documentation of the library predicates. The <I>comment</I> directives come in two flavours. One is a comment for a module<A NAME="313"></A><A NAME="314"></A>, which gives an overview what is module is for. As an example we again use the file <I>flow_prepare_data.ecl</I>.
<PRE>
:-comment(summary,"This file contains the data preparation for 
the flow analysis.").
:-comment(desc,html("This file contains the data preparation for 
the flow analysis.
")).
:-comment(author,"R. Rodosek, H. Simonis").
:-comment(copyright,"Parc Technologies Ltd").
:-comment(date,"$Date: 2003/04/29 17:49:48 $").
</PRE>
The other form of the <I>comment</I> directive is the predicate comment<A NAME="319"></A><A NAME="320"></A>, which describes a particular predicate.
<PRE>
:-comment(prepare_data/12,[
summary:"creates the data structures for the flow analysis
",
amode:prepare_data(+,+,+,-,-,-,-,-,-,+,-,-),
args:[
"Dir":"directory for report output",
"Type":"the type of report to be generated",
"Summary":"a summary term",
"Nodes":"a nodes data structure",
"Interfaces":"a interfaces data structure",
"Lines":"a lines data structure",
"Groups":"a groups data structure",
"CMatrix":"a matrix (indexed by nodes) of contributions to 
traffic",
"FMatrix":"a matrix (indexed by nodes) of flow variables",
"ScaleFactor":"the scale factor applied to the traffic data",
"Sizes":"the sizes of min, small, large, max packets",
"PMatrix":"The Pi Matrix containing the next hop information, 
indexed by node keys"
],
desc:html("
This route creates the data structures for the flow analysis. 
...
"),
see_also:[hop/3]
]).
</PRE>
The exact form of the different fields is described in the the documentation of the <I>directives</I> <A NAME="324"></A>section of the ECLiPSe built-in predicate documentation in the ECLiPSe reference manual.

<P>

<H2><A NAME="SECTION00372000000000000000">
Documenting all interfaces</A>
</H2>
Many predicates in a module only perform very simple tasks which are immediately obvious from the implementation. It would be overkill to document all these predicates. We are working with a rule that all module interfaces must be documented, as well as all predicates which either have a complex implementation or which are expected to be customized by the user.

<P>
For predicates without a comment directive, we should use a one line description by a normal ECLiPSe comment in the source code. 

<P>

<H2><A NAME="SECTION00373000000000000000">
Mode declaration</A>
</H2>
We also use mode declarations <A NAME="327"></A>to document the calling pattern <A NAME="328"></A>of predicates. This uses four symbols
<DL>
<DT><STRONG>+</STRONG>
<DD>for arguments which are <I>instantiated</I><A NAME="331"></A>, i.e. are not free variables, but which may contain variables
<DT><STRONG>++</STRONG>
<DD>for arguments that are <I>ground</I><A NAME="333"></A>, i.e. do not contain variables
<DT><STRONG>-</STRONG>
<DD>for arguments which are free variables
<DT><STRONG>?</STRONG>
<DD>for an unknown mode, where we either don't know the mode or we do not care if the argument is instantiated or not
</DL>
While the compiler uses the mode declarations for code optimization, we basically only use it to document the calling pattern. It allows to isolate a predicate definition and to understand its purpose without checking all callers<A NAME="tex2html7"
 HREF="footnode.html#foot335"><SUP>2.3</SUP></A>.

<P>
To continue with our example module <I>flow_prepare_data</I>, the one exported predicate has the following mode declaration<A NAME="tex2html8"
 HREF="footnode.html#foot337"><SUP>2.4</SUP></A>.
<PRE>
:-mode prepare_data(+,+,+,-,-,-,-,-,-,+,-,-).
</PRE>
<H2><A NAME="SECTION00374000000000000000">
Documentation query</A>
</H2>
If a system contains many modules, it can be helpful to provide a query which automatically generates the documentation for all files. In RiskWise, there is a module <I>document</I> <A NAME="342"></A>with an entry point <I>document/0</I> which creates the complete documentation tree. It uses the built-in predicates <I>icompile/1</I> and <I>ecis_to_htlms/4</I> to extract the documentation information from the source files and to build the HTML files required. Whenever we add a new module to the source of the application, we have to add its name into the <I>components</I> list.
<PRE>
document:-
        components(L),
        (foreach(Module,L) do
           icompile(Module)
        ),
        getcwd(Dir),
        ecis_to_htmls([Dir],'HTML Doc',[],'ApplicationName').


components([
        module1,
        module2,
        ...
        modulen]).
</PRE><HR>
<!--Navigation Panel-->
<A NAME="tex2html532"
 HREF="node14.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html526"
 HREF="node6.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html522"
 HREF="node12.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html528"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A> 
<A NAME="tex2html530"
 HREF="node78.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html533"
 HREF="node14.html">Data Structures</A>
<B> Up:</B> <A NAME="tex2html527"
 HREF="node6.html">High Level Design</A>
<B> Previous:</B> <A NAME="tex2html523"
 HREF="node12.html">Naming schemes</A>
 &nbsp <B>  <A NAME="tex2html529"
 HREF="node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html531"
 HREF="node78.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
