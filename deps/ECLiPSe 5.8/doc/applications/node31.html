<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Filter</TITLE>
<META NAME="description" CONTENT="Filter">
<META NAME="keywords" CONTENT="tutorial">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="tutorial.css">
<LINK REL="next" HREF="node32.html">
<LINK REL="previous" HREF="node30.html">
<LINK REL="up" HREF="node24.html">
<LINK REL="next" HREF="node32.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html925"
 HREF="node32.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html919"
 HREF="node24.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html913"
 HREF="node30.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html921"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A> 
<A NAME="tex2html923"
 HREF="node78.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html926"
 HREF="node32.html">Combine</A>
<B> Up:</B> <A NAME="tex2html920"
 HREF="node24.html">Programming Concepts</A>
<B> Previous:</B> <A NAME="tex2html914"
 HREF="node30.html">Transformation</A>
 &nbsp <B>  <A NAME="tex2html922"
 HREF="node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html924"
 HREF="node78.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html927"
 HREF="node31.html#SECTION00670010000000000000">Description</A>
<LI><A NAME="tex2html928"
 HREF="node31.html#SECTION00670020000000000000">Parameters</A>
<LI><A NAME="tex2html929"
 HREF="node31.html#SECTION00670030000000000000">Schema</A>
<LI><A NAME="tex2html930"
 HREF="node31.html#SECTION00670040000000000000">Comments</A>
<LI><A NAME="tex2html931"
 HREF="node31.html#SECTION00670050000000000000">Example</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00670000000000000000">
Filter</A>
</H1>

<H4><A NAME="SECTION00670010000000000000">
Description</A>
</H4>
The filter<A NAME="608"></A> concept extracts from a list of elements those that satisfy some condition <I>q</I> and returns a list of these elements.

<P>
We present three implementations, one using recursion, the others using a <I>do</I> loop with the <I>fromto</I><A NAME="612"></A> keyword.

<H4><A NAME="SECTION00670020000000000000">
Parameters</A>
</H4>
<DL>
<DT><STRONG>L</STRONG>
<DD>a list
<DT><STRONG>K</STRONG>
<DD>a free variable, will be bound to a list
</DL>
<H4><A NAME="SECTION00670030000000000000">
Schema</A>
</H4>
<PRE>
/* version 1 */

:-mode filter(+,-).
filter([],[]).
filter([A|A1],[A|B1]):-
        q(A),
        !,
        filter(A1,B1).
filter([_A|A1],B1):-
        filter(A1,B1).

/* version 2 */

:-mode filter(+,-).
filter(L,K):-
        (foreach(X,L),
         fromto([],In,Out,K) do
            q(X,In,Out)
        ).

q(X,L,[X|L]):-
        q(X),
        !.
q(_,L,L).
</PRE>

<PRE>
/* version 3 */

:-mode filter(+,-).
filter(L,K):-
        (foreach(X,L),
         fromto(K,In,Out,[]) do
            q(X,In,Out)
        ).

q(X,[X|L],L):-
        q(X),
        !.
q(_,L,L).
</PRE>
<H4><A NAME="SECTION00670040000000000000">
Comments</A>
</H4>
The difference between versions 2 and 3 lies in the order of the elements in the result list. Version 2 produces the elements in the inverse order of version 1, whereas version 3 produces them in the same order as version 1. This shows that the <I>fromto</I> statement can be used to build lists forwards or backwards. Please note that the predicate <I>q/3</I> is also different in variants 2 and 3.

<P>
The cuts (!) <A NAME="624"></A>in the program clauses are very important, as they remove the possibility that a selected element is not included in the filtered list. If we remove the cuts, then the <I>filter</I> predicate has an exponential number of ``solutions''. Only the first solution will be correct, on backtracking we will decide to reject elements which satisfy the test criterion and we will explore all combinations until we reach the empty list as the last ``solution''.

<H4><A NAME="SECTION00670050000000000000">
Example</A>
</H4>
The following program is used to extract interfaces related to customers (types customer, selected and remaining) as a list of <I>customer/3</I> terms, group them by node and perform some action on each group.
<A NAME="628"></A>
<A NAME="629"></A>
<PRE>
:-mode selected_min_max(+,+).
selected_min_max(Type,Interfaces):-
        Interfaces = interfaces with list:List,
        (foreach(Interface,List),
         fromto([],In,Out,Customers) do
            selected_customer(Interface,In,Out)
        ),
        sort(0,=&lt;,Customers,Sorted),
        customers_by_node(Sorted,Grouped),
        selected_together(Type,Grouped,Interfaces).

selected_customer(interface with [type:Type,
                                  index:I,
                                  node_index:Node],
                  In,
                  [customer with [node:Node,
                                  index:I,
                                  type:Type]|In]):-
        memberchk(Type,[customer,selected,remaining]),
        !.
% all other types: backbone,backbone_net,interconnection,local
selected_customer(_,In,In).
</PRE>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html925"
 HREF="node32.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html919"
 HREF="node24.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html913"
 HREF="node30.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A> 
<A NAME="tex2html921"
 HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents_motif.gif"></A> 
<A NAME="tex2html923"
 HREF="node78.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html926"
 HREF="node32.html">Combine</A>
<B> Up:</B> <A NAME="tex2html920"
 HREF="node24.html">Programming Concepts</A>
<B> Previous:</B> <A NAME="tex2html914"
 HREF="node30.html">Transformation</A>
 &nbsp <B>  <A NAME="tex2html922"
 HREF="node1.html">Contents</A></B> 
 &nbsp <B>  <A NAME="tex2html924"
 HREF="node78.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
