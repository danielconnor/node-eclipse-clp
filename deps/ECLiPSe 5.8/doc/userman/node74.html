<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Interrupts</TITLE>
<META NAME="description" CONTENT="Interrupts">
<META NAME="keywords" CONTENT="umsroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="umsroot.css">
<LINK REL="previous" HREF="node73.html">
<LINK REL="up" HREF="node71.html">
<LINK REL="next" HREF="node75.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3377"
 HREF="node75.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3373"
 HREF="node71.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3369"
 HREF="node73.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3375"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3378"
 HREF="node75.html">Debugging</A>
<B> Up:</B> <A NAME="tex2html3374"
 HREF="node71.html">Events and Interrupts</A>
<B> Previous:</B> <A NAME="tex2html3370"
 HREF="node73.html">Errors</A>
 &nbsp <B>  <A NAME="tex2html3376"
 HREF="node158.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html3379"
 HREF="node74.html#SECTION001331000000000000000">Interrupt Identifiers</A>
<LI><A NAME="tex2html3380"
 HREF="node74.html#SECTION001332000000000000000">Asynchronous handling</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION001330000000000000000"></A>
<A NAME="sectinterrupts"></A><A NAME="7115"></A>
<BR>
Interrupts
</H1>
Operating systems such as Unix provide a notion of asynchronous interrupts
or signals. In a standalone ECLiPSe system, the signals can be handled by
defining interrupt handlers for them. In fact, a set of
default handlers is already predefined in this case.

<P>
In an embedded ECLiPSe, signals are usually handled by the host
application, and it is recommended to use the event mechanism described above
(the ec_post_event() library function) to communicate between the host
application and the ECLiPSe code.
However, even in this setting, ECLiPSe can also handle signals directly,
provided the programmer sets up a corresponding interrupt handler.

<P>

<H2><A NAME="SECTION001331000000000000000">
Interrupt Identifiers</A>
</H2>
Interrupts are identified either by their signal number (Unix) or
by a name which is derived from the name the signal has in the operating
system. Most built-ins understand both identifiers. It is usually
more portable to use the symbolic name.
The built-in <A NAME="tex2html1067"
 HREF="../bips/kernel/event/current_interrupt-2.html">current_interrupt/2</A><A NAME="7262"></A> is provided to check and/or
generate the valid interrupt numbers and their mnemonic names.

<P>

<H2><A NAME="SECTION001332000000000000000">
Asynchronous handling</A>
</H2>

<P>
When an interrupt happens, the ECLiPSe system
calls an interrupt handling routine in a manner very similar to
the case of event handling. The only argument to the handler is
the interrupt number.
Just as event handlers may be user defined, so it is possible to define
interrupt handlers. The goal<PRE>
set_interrupt_handler(N, PredSpec)
</PRE>
<A NAME="7129"></A>
assigns the procedure specified by <I>PredSpec</I> as the interrupt handler for
the interrupt identified by <I>N</I> (a number or a name).
Some interrupts cannot be caught by the user (e.g. the <I>kill</I> signal),
trying to establish a handler for them yields an error message. Note that
<I>PredSpec</I> should be one of the predefined handlers. The use of general
user defined predicates is deprecated because of portability considerations.

<P>
To test interrupt handlers, the built-in <A NAME="tex2html1070"
 HREF="../bips/kernel/opsys/kill-2.html">kill/2</A><A NAME="7265"></A> may be used to send
a signal to the own process.

<P>
The predicate <A NAME="tex2html1072"
 HREF="../bips/kernel/event/get_interrupt_handler-3.html">get_interrupt_handler/3</A><A NAME="7268"></A>
may be used to find the
current interrupt handler for an interrupt N, in the same manner as
<B>get_event_handler</B>:<PRE>
get_interrupt_handler(N, PredSpec, HomeModule)
</PRE>

<P>
An interrupt handler has one optional argument, which is the interrupt
number.
There is no argument corresponding to the error culprit, since
the interrupt has no relation to the currently executed predicate.
A handler may be defined which takes no argument (such
as when the handler is defined for only one interrupt type).
If the handler has one argument, the identifier of the interrupt is passed
to the handler when it is called.

<P>
The following is the list of predefined interrupt handlers:
<DL>
<DT><STRONG>default/0</STRONG>
<DD><A NAME="7144"></A> 
<BR>
performs the standard UNIX handling of the specified interrupt (signal).
    Setting this handler is equivalent to calling <I>signal(N, SIG_DFL)</I>
    on the C level.
    Thus e.g. specifying
    <PRE>
    ?- set_interrupt_handler(int, default/0)
</PRE>
    will exit the ECLiPSe system when <code>^</code>C is pressed.

<P>
<DT><STRONG>true/0</STRONG>
<DD><A NAME="7152"></A> 
<BR>
This is equivalent to calling <I>signal(N, SIG_IGN)</I> on the C level,
    ie. the interrupt is ignored.

<P>
<DT><STRONG>throw/1</STRONG>
<DD><A NAME="7154"></A> 
<BR>
Invoke <I>exit_block/1</I> with the interupt's symbolic name.
<DT><STRONG>abort/0</STRONG>
<DD><A NAME="7156"></A> 
<BR>
Invoke <I>exit_block(abort)</I>.
<DT><STRONG>halt/0</STRONG>
<DD><A NAME="7158"></A> 
<BR>
Terminate the ECLiPSe process.
<DT><STRONG>internal/0</STRONG>
<DD>Used by ECLiPSe to implement internal functionality like the
    profiler. This is not intended to be used by the user.
<DT><STRONG>event/1</STRONG>
<DD><A NAME="7161"></A> 
<BR>
The signal is handled by posting a (synchronous) event. The event
    name is the symbolic name of the interrupt.
</DL>
Apart from these special cases, all other arguments will
result in the specified predicate to be called when the appropriate
interrupt occurs. This general asynchronous interrupt handling
is not supported on all hardware/platforms,
neither in an embedded ECLiPSe (including the
<A NAME="7164"></A> tkeclipse development environment),
and is therefore deprecated.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html3377"
 HREF="node75.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3373"
 HREF="node71.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3369"
 HREF="node73.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3375"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3378"
 HREF="node75.html">Debugging</A>
<B> Up:</B> <A NAME="tex2html3374"
 HREF="node71.html">Events and Interrupts</A>
<B> Previous:</B> <A NAME="tex2html3370"
 HREF="node73.html">Errors</A>
 &nbsp <B>  <A NAME="tex2html3376"
 HREF="node158.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
