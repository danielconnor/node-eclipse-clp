<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Waiting for other Constraints</TITLE>
<META NAME="description" CONTENT="Waiting for other Constraints">
<META NAME="keywords" CONTENT="umsroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="umsroot.css">
<LINK REL="previous" HREF="node120.html">
<LINK REL="up" HREF="node118.html">
<LINK REL="next" HREF="node122.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html4051"
 HREF="node122.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html4047"
 HREF="node118.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html4043"
 HREF="node120.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html4049"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html4052"
 HREF="node122.html">Memory Organisation And Garbage</A>
<B> Up:</B> <A NAME="tex2html4048"
 HREF="node118.html">More About Suspension</A>
<B> Previous:</B> <A NAME="tex2html4044"
 HREF="node120.html">Waiting for Binding</A>
 &nbsp <B>  <A NAME="tex2html4050"
 HREF="node158.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION001830000000000000000"></A>
<A NAME="11611"></A>
<BR>
Waiting for other Constraints
</H1>
The <B>constrained</B> list in the <B>suspend</B> attribute
is used for instance in generic predicates which have to be
notified about the possible change of the state of a variable,
especially its unifyability with other terms.
Our example with the <B>dif</B> predicate could be for instance
extended to work with finite domain or other constrained
variables.
The modification is fairly simple:

<UL><LI>When a variable in one term is matched against a subterm of the
other term, it might not necessarily be unifyable with it, because
there might be other constraints imposed on it.
Therefore, <A NAME="tex2html1562"
 HREF="../bips/kernel/termcomp/not_unify-2.html">not_unify/2</A><A NAME="11656"></A> must be used to test it explicitly.

<P>

<LI>The suspension should be woken not only on binding, but
on any constraining and thus the <B>constrained</B> list
has to be used.

</UL>

<P>
The predicate <B>compare_args/5</B> is thus changed as follows:<PRE>
compare_args(_, _, _, _, Yes) :-
    nonvar(Yes).
compare_args(A1, A2, Link, NewLink, Yes) :-
    var(Yes),
    (A1 == A2 -&gt;
        Link = NewLink
    ;
    (var(A1);var(A2)) -&gt;
        (not_unify(A1, A2) -&gt;
            Yes = yes
        ;
            suspend(compare_args(A1, A2, Link, NewLink, Yes), 3,
		[[A1|A2]-&gt;constrained, Yes-&gt;inst])
        )
    ;
        compare_terms(A1, A2, Link, NewLink, Yes)
    ).
</PRE>

<P>
Now our <B>dif3/4</B> predicate yields correct results even for
constrained variables:<PRE>
[eclipse 1]: dif3(A, B, Y, N), A::1..10, B::20..30.

Y = yes
N = N
A = A{[1..10]}
B = B{[20..30]}
yes.
[eclipse 2]: dif3(A, B, Y, N), A::1..10, B = 5, A ## 5.
 
Y = yes
N = N
B = 5
A = A{[1..4, 6..10]}
yes.
[eclipse 18]: dif3(A, B, Y, N), A + B $= 1, A $= 1/2.

Y = Y
N = no
B = 1 / 2
A = 1 / 2
yes.
</PRE>

<P>
<BR><HR>
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
