<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>More about Priorities</TITLE>
<META NAME="description" CONTENT="More about Priorities">
<META NAME="keywords" CONTENT="umsroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="umsroot.css">
<LINK REL="next" HREF="node116.html">
<LINK REL="previous" HREF="node114.html">
<LINK REL="up" HREF="node105.html">
<LINK REL="next" HREF="node116.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3976"
 HREF="node116.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3972"
 HREF="node105.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3966"
 HREF="node114.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3974"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3977"
 HREF="node116.html">Details of the Execution</A>
<B> Up:</B> <A NAME="tex2html3973"
 HREF="node105.html">Advanced Control Features</A>
<B> Previous:</B> <A NAME="tex2html3967"
 HREF="node114.html">Demon Predicates</A>
 &nbsp <B>  <A NAME="tex2html3975"
 HREF="node158.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html3978"
 HREF="node115.html#SECTION0017101000000000000000">Changing Priority Explicitly</A>
<LI><A NAME="tex2html3979"
 HREF="node115.html#SECTION0017102000000000000000">Choice of Priorities</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION0017100000000000000000">
More about Priorities</A>
</H1>
For the scheduled goals,
ECLiPSe uses an execution model which is based on goal <I>priorities</I>
and which guarantees that a scheduled goal with a higher priority
will be always executed before any goal with lower priority.
Priority is a small integer number ranging from 1 to 12,
1 being the highest priority and 12 the lowest
(cf. figure&nbsp;<A HREF="node107.html#figresolv">17.1</A>).
All goals started from the ECLiPSe top-level loop
or from the command line with the -e option have priority 12.
Each suspension and each goal which is being
executed therefore has an associated priority.
The priority of the currently executing goal can be determined
with <A NAME="tex2html1517"
 HREF="../bips/kernel/suspensions/get_priority-1.html">get_priority/1</A><A NAME="10974"></A>.

<P>
Priority-based execution is driven by a scheduler:
It picks up the scheduled suspension with the highest priority.
If its priority is higher than the priority of the currently
executing goal, then the execution of the current goal
is interrupted and the new suspension is executed.
This is repeated until there are no suspensions
with priority higher than that of the current goal.

<P>

<H2><A NAME="SECTION0017101000000000000000">
Changing Priority Explicitly</A>
</H2>
It is also possible to execute a goal with a given priority
by means of
<A NAME="tex2html1519"
 HREF="../bips/kernel/suspensions/call_priority-2.html">call_priority(Goal, Prio)</A><A NAME="10977"></A>
which calls <B>Goal</B> with the priority <B>Prio</B>.
When a goal is called this way with high priority, it is effectively
made atomic, ie. it will not be interrupted by goals with lower priority
that wake up while it executes.
Those goals will all be deferred until exit from
<A NAME="tex2html1521"
 HREF="../bips/kernel/suspensions/call_priority-2.html">call_priority/2</A><A NAME="10980"></A>.
This technique can sometimes improve efficiency.
Consider for example the following program:<PRE>
p(1).
report(Term) :-
    writeln(term=Term),
    suspend(report(Term),3,Term-&gt;inst).
</PRE>
and the execution<PRE>
[eclipse 2]: report(f(X,Y,Z)), p(X),p(Y),p(Z).
term = f(X, Y, Z)
term = f(1, Y, Z)
term = f(1, 1, Z)
term = f(1, 1, 1)
</PRE>
report/1 is woken and executed three times, once for each variable binding.
If instead we do the three bindings under high priority, it will only
execute once after all bindings have already been done:<PRE>
[eclipse 3]: report(f(X,Y,Z)), call_priority((p(X),p(Y),p(Z)), 2).
term = f(X, Y, Z)
term = f(1, 1, 1)
</PRE>

<P>

<H2><A NAME="SECTION0017102000000000000000">
Choice of Priorities</A>
</H2>
Although the programmer is more or less free to specify
which priorities to use, we strongly recommend
to stick to the following scheme (from urgent to less urgent):
<DL>
<DT><STRONG>debugging (1)</STRONG>
<DD>goals which don't contribute to the semantics
of the program and always succeed, e.g. display routines, consistency
checks or data breakpoints.

<P>
<DT><STRONG>immediate</STRONG>
<DD>goals which should be woken immediately
and which do not do any bindings or other updates.
Examples are quick tests which can immediately fail and
thus avoid redundant execution.

<P>
<DT><STRONG>quick</STRONG>
<DD>fast deterministic goals which may
propagate changes to other variables.

<P>
<DT><STRONG>normal</STRONG>
<DD>deterministic goals which should be woken
after the <B>quick</B> class.

<P>
<DT><STRONG>slow</STRONG>
<DD>deterministic goals which require
a lot of processing, e.g. complicated disjunctive
constraints.

<P>
<DT><STRONG>delayed</STRONG>
<DD>nondeterministic goals
or goals which are extremely slow.

<P>
<DT><STRONG>toplevel goal (12)</STRONG>
<DD>the default priority of the user program.
</DL>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html3976"
 HREF="node116.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3972"
 HREF="node105.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3966"
 HREF="node114.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3974"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3977"
 HREF="node116.html">Details of the Execution</A>
<B> Up:</B> <A NAME="tex2html3973"
 HREF="node105.html">Advanced Control Features</A>
<B> Previous:</B> <A NAME="tex2html3967"
 HREF="node114.html">Demon Predicates</A>
 &nbsp <B>  <A NAME="tex2html3975"
 HREF="node158.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
