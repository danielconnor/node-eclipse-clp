<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Line coverage</TITLE>
<META NAME="description" CONTENT="Line coverage">
<META NAME="keywords" CONTENT="umsroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="umsroot.css">
<LINK REL="next" HREF="node93.html">
<LINK REL="previous" HREF="node91.html">
<LINK REL="up" HREF="node84.html">
<LINK REL="next" HREF="node93.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3636"
 HREF="node93.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3632"
 HREF="node84.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3626"
 HREF="node91.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3634"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3637"
 HREF="node93.html">Mode analysis</A>
<B> Up:</B> <A NAME="tex2html3633"
 HREF="node84.html">Development Support Tools</A>
<B> Previous:</B> <A NAME="tex2html3627"
 HREF="node91.html">Port Profiler</A>
 &nbsp <B>  <A NAME="tex2html3635"
 HREF="node158.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html3638"
 HREF="node92.html#SECTION001581000000000000000">Compilation</A>
<LI><A NAME="tex2html3639"
 HREF="node92.html#SECTION001582000000000000000">Results</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION001580000000000000000"></A>
<A NAME="9344"></A>
<A NAME="9345"></A>
<A NAME="9346"></A>
<BR>
Line coverage
</H1>
The line coverage library provides a means to ascertain exactly how
many times individual clauses are called during the evaluation of a
query.

<A NAME="9347"></A>
The library works by placing <I>coverage counters</I> at strategic
points throughout the code being analysed.  These counters are
incremented each time the evaluation of a query passes them.  There
are three locations in which coverage counters can be inserted.
<DL COMPACT>
<DT>1.
<DD>At the beginning of a code block.
<DT>2.
<DD>Between predicate calls within a code block.
<DT>3.
<DD>At the end of a code block.
</DL>
A code block is defined to be a conjunction of predicate calls. ie. a
sequence of goals separated by commas.

The counter values do not only show whether all code points were 
reached but also whether subgoals failed or aborted (in which case 
the counter before a subgoal will have a higher value than the 
counter after it).

<H2><A NAME="SECTION001581000000000000000"></A>
<A NAME="9352"></A>
<A NAME="9353"></A>
<BR>
Compilation
</H2>
In order to add the coverage counters to code, it must be compiled with
the <A NAME="tex2html1284"
 HREF="../bips/lib/coverage/ccompile-1.html">ccompile/1</A><A NAME="9436"></A>
predicate which can be found in the 
<A NAME="tex2html1286"
 HREF="../bips/lib/coverage/index.html">coverage</A><A NAME="9439"></A> library.

The <TT>ccompile/1</TT> predicate (note the initial `c' stands for
coverage) can be used in place of the normal <TT>compile/1</TT>
predicate to compile a file with coverage counters.

The following shows the results of compiling the <B>n-queens</B> example:<PRE>

?- coverage:ccompile(queen).
queen.ecl  compiled traceable 6016 bytes in 0.01 seconds
coverage: inserted 20 coverage counters into module queen 

Yes (0.14s cpu)
</PRE>

Once compiled, predicates can be called as usual and will (by default)
have no visible side effects. Internally however, the counters will
be incremented as the execution progresses. The following demonstrates
this for a single solution to the <TT>queen</TT> predicate:<PRE>

?- queen:queen([1,2,3,4,5,6,7,8,9], Out).
</PRE>
The counter results are retrieved as demonstrated in the subsequent section.
The two argument predicate <TT>ccompile/2</TT> <A NAME="9371"></A>
<A NAME="9372"></A> can take a list of <TT>name:value</TT> pairs
which can be used to control the exact manner in which coverage
counters are inserted. The documentation for the 
<A NAME="tex2html1290"
 HREF="../bips/lib/coverage/ccompile-2.html">ccompile/2</A><A NAME="9442"></A> predicate
provides for a full list of the available flags.

<H2><A NAME="SECTION001582000000000000000"></A>

<A NAME="9377"></A> <A NAME="9378"></A>
<BR>
Results
</H2> To generate an HTML file
containing the coverage counter results, the 
<A NAME="tex2html1294"
 HREF="../bips/lib/coverage/result-1.html">result/1</A><A NAME="9445"></A> predicate is used:<PRE>

?- coverage:result(queen).
Writing /examples/coverage/queen.html
index.pl   compiled traceable 335304 bytes in 0.17 seconds

Yes (0.18s cpu)
</PRE>
This creates the result file <TT>coverage/queens.html</TT> which
can be viewed using any browser.  It contains a pretty-printed form of
the source, annotated with the values of the code coverage counters as
described above. As a side effect, the coverage counters will be reset.

<HR>
<!--Navigation Panel-->
<A NAME="tex2html3636"
 HREF="node93.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3632"
 HREF="node84.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3626"
 HREF="node91.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3634"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3637"
 HREF="node93.html">Mode analysis</A>
<B> Up:</B> <A NAME="tex2html3633"
 HREF="node84.html">Development Support Tools</A>
<B> Previous:</B> <A NAME="tex2html3627"
 HREF="node91.html">Port Profiler</A>
 &nbsp <B>  <A NAME="tex2html3635"
 HREF="node158.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
