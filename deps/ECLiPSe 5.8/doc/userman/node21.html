<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Structure Notation</TITLE>
<META NAME="description" CONTENT="Structure Notation">
<META NAME="keywords" CONTENT="umsroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="umsroot.css">
<LINK REL="next" HREF="node22.html">
<LINK REL="previous" HREF="node20.html">
<LINK REL="up" HREF="node20.html">
<LINK REL="next" HREF="node22.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html2560"
 HREF="node22.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html2556"
 HREF="node20.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html2550"
 HREF="node20.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html2558"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2561"
 HREF="node22.html">Loop/Iterator Constructs</A>
<B> Up:</B> <A NAME="tex2html2557"
 HREF="node20.html">ECLiPSe-specific Language Features</A>
<B> Previous:</B> <A NAME="tex2html2551"
 HREF="node20.html">ECLiPSe-specific Language Features</A>
 &nbsp <B>  <A NAME="tex2html2559"
 HREF="node158.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html2562"
 HREF="node21.html#SECTION00511000000000000000">Updating Structures</A>
<LI><A NAME="tex2html2563"
 HREF="node21.html#SECTION00512000000000000000">Arity and Functor of Structures</A>
<LI><A NAME="tex2html2564"
 HREF="node21.html#SECTION00513000000000000000">Printing Structures</A>
<LI><A NAME="tex2html2565"
 HREF="node21.html#SECTION00514000000000000000">Inheritance</A>
<LI><A NAME="tex2html2566"
 HREF="node21.html#SECTION00515000000000000000">Visibility</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00510000000000000000"></A>
<A NAME="chapstruct"></A><A NAME="1978"></A>
<BR>
Structure Notation
</H1>

<P>
ECLiPSe structure notation provides a way to use structures with field names.
It is intended to make programs more readable and easier
to modify, without compromising efficiency
(it is implemented by preprocessing).

<P>
A structure is declared by specifying a template like this
<A NAME="1980"></A>
<A NAME="1981"></A>
<A NAME="1982"></A><PRE>
:- local struct( book(author, title, year, publisher) ).
</PRE>
Structures with the functor book/4 can then be written as
<A NAME="1987"></A>
<A NAME="1988"></A><PRE>
book{}
book{title:'tom sawyer'}
book{title:'tom sawyer', year:1886, author:twain}
</PRE>
which translate to the corresponding forms<PRE>
book(_, _, _, _)
book(_, 'tom sawyer', _, _)
book(twain, 'tom sawyer', 1886, _)
</PRE>
This transformation is done by the parser, therefore it can
be used in any context and is as efficient as using the structures
directly.

<P>
The argument index of a field in a structure can be obtained
using a term of the form
<A NAME="1997"></A><PRE>
FieldName of StructName
</PRE>
E.g. to access (ie. unify) a single argument of a structure,
use arg/3 like this:<PRE>
..., arg(year of book, B, Y), ...
</PRE>
which is translated into<PRE>
..., arg(3, B, Y), ...
</PRE>

<P>
If a program is consistently written using <B>curly-brace</B> and <B>of</B>
syntax, then the struct-declaration can be modified (fields added or
rearranged) without having to update the code anywhere else.

<P>

<H2><A NAME="SECTION00511000000000000000">
Updating Structures</A>
</H2>

<P>
To construct an updated structure, i.e. a structure which is similar
to an existing structure except that one or more fields have new
values, use the
<A NAME="tex2html159"
 HREF="../bips/kernel/termmanip/update_struct-4.html">update_struct/4</A><A NAME="2357"></A>
built-in, which allows to do that without having to mention all the
other field names in the structure.

<P>

<H2><A NAME="SECTION00512000000000000000">
Arity and Functor of Structures</A>
</H2>

<P>
The arity of a structure can be symbolically written using <B>of/2</B>
as follows:<PRE>
property(arity) of StructName
</PRE>
For example,<PRE>
?- printf("A book has %d fields%n", [property(arity) of book]).
A book has 4 fields
Yes.
</PRE>
Similarly, the whole StructName/Arity specification can be written as<PRE>
property(functor) of StructName
</PRE>
which is used for the portray-declaration in the example below.

<P>

<H2><A NAME="SECTION00513000000000000000">
Printing Structures</A>
</H2>
When structures are printed, they are not translated back into the
curly-brace-syntax by default. The reason this is not done is that this can
be bulky if all fields are printed, and often
it is desirable to hide some of the fields anyway.

<P>
A good way to control printing of big structures is to write
special purpose portray-transformations for them, for instance<PRE>
:- local portray(property(functor) of book, tr_book_out/2, []).
tr_book_out(book{author:A,title:T},
        no_macro_expansion(book{author:A,title:T})).
</PRE>
<A NAME="2034"></A>
which will cause book/4 structures to be printed like<PRE>
book{author:twain, title:tom sawyer}
</PRE>
while the other two arguments remain hidden.

<P>

<H2><A NAME="SECTION00514000000000000000"></A>
<A NAME="2040"></A>
<BR>
Inheritance
</H2>
Structures can be declared to contain other structures,
in which case they inherit the base structure's field names.
Consider the following declarations:<PRE>
:- local struct(person(name,address,age)).
:- local struct(employee(p:person,salary)).
</PRE>
The <code>employee</code> structure contains a field <code>p</code> which is a
<code>person</code> structure.
Field names of the <code>person</code> structure can now be used as if
they were field names of the <code>employee</code> structure:<PRE>
[eclipse 1]: Emp = employee{name:john,salary:2000}.
Emp = employee(person(john, _105, _106), 2000)
yes.
</PRE>
Note that, as long as the <B>curly-brace</B> and <B>of</B> syntax is used,
the <code>employee</code> structure can be viewed either as nested or as flat,
depending on what is more convenient in a given situation.
In particular, the embedded structure can still be accessed as a whole:<PRE>
[eclipse 1]:
        Emp = employee{name:john,age:30,salary:2000,address:here},
        arg(name of employee, Emp, Name),
        arg(age of employee, Emp, Age),
        arg(salary of employee, Emp, Salary),
        arg(address of employee, Emp, Address),
        arg(p of employee, Emp, Person).
        
Emp = employee(person(john, here, 30), 2000)
Name = john
Age = 30
Salary = 2000
Address = here
Person = person(john, here, 30)
yes.
</PRE>
The indices of nested structures expand into
lists of integers rather than simple integers,
e.g. <code>age of employee</code> expands into <code>[1,3]</code>.

<P>

<H2><A NAME="SECTION00515000000000000000">
Visibility</A>
</H2>
Structure declaration can be local to a module (when declared as above)
or exported when declared as
<A NAME="2056"></A><PRE>
:- export struct(...).
</PRE>
in the module.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html2560"
 HREF="node22.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html2556"
 HREF="node20.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html2550"
 HREF="node20.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html2558"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html2561"
 HREF="node22.html">Loop/Iterator Constructs</A>
<B> Up:</B> <A NAME="tex2html2557"
 HREF="node20.html">ECLiPSe-specific Language Features</A>
<B> Previous:</B> <A NAME="tex2html2551"
 HREF="node20.html">ECLiPSe-specific Language Features</A>
 &nbsp <B>  <A NAME="tex2html2559"
 HREF="node158.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
