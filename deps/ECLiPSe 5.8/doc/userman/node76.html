<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>The Box Model</TITLE>
<META NAME="description" CONTENT="The Box Model">
<META NAME="keywords" CONTENT="umsroot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="umsroot.css">
<LINK REL="next" HREF="node77.html">
<LINK REL="previous" HREF="node75.html">
<LINK REL="up" HREF="node75.html">
<LINK REL="next" HREF="node77.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html3423"
 HREF="node77.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3419"
 HREF="node75.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3413"
 HREF="node75.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3421"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3424"
 HREF="node77.html">Format of the Tracing</A>
<B> Up:</B> <A NAME="tex2html3420"
 HREF="node75.html">Debugging</A>
<B> Previous:</B> <A NAME="tex2html3414"
 HREF="node75.html">Debugging</A>
 &nbsp <B>  <A NAME="tex2html3422"
 HREF="node158.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION001410000000000000000"></A>
<A NAME="boxmodel"></A>
<BR>
The Box Model
</H1>

<P>
The ECLiPSe debugger is based on a port model which is an extension
of the classical Box Model commonly used in Prolog debugging.

<P>
A procedure invocation (or goal) is represented by a box with entry
and exit ports.  Each time a procedure is invoked, a box is created
and given a unique invocation number.  The invocations of subgoals of
this procedure are seen as boxes inside this procedure box.

<P>

<P></P>
<DIV ALIGN="CENTER"><A NAME="7472"></A>
<TABLE>
<CAPTION><STRONG>Figure 14.1:</STRONG>
The box model</CAPTION>
<TR><TD>
<DIV ALIGN="CENTER">
</DIV><!-- MATH: $\includegraphics{boxmodel.eps}$ -->
<IMG
 WIDTH="625" HEIGHT="377" ALIGN="BOTTOM" BORDER="0"
 SRC="img9.gif"
 ALT="\includegraphics{boxmodel.eps}">
<DIV ALIGN="CENTER">
</DIV></TD></TR>
</TABLE>
</DIV><P></P>

<P>
Tracing the flow of the execution consists in tracing the crossing of
the execution flow through any of the port of the box.

<P>
The five basic ports of the box model of ECLiPSe are the CALL, EXIT,
REDO, FAIL and NEXT ports, the suspension facilities are traced through
the DELAY and RESUME ports, and the exceptional exit is indicated by LEAVE.

<P>
<DL>
<DT><STRONG>CALL:</STRONG>
<DD>When a procedure is invoked, the flow of the execution
enters the procedure box by its CALL port and enters the first clause
box which could (since not all clauses are tried, some of them being
sure to fail, i.e. indexing is shown) unify with the goal.
It may happen that a procedure is
called with arguments that make it sure to fail (because of
indexing). In such cases, the flow does not enter any clause box.
<P>
For each CALL port a new procedure box is created and is given:

<UL><LI>an <I>invocation number</I> that is one higher than that given for
the most recent CALL port. This allows to uniquely identify a
procedure invocation and all its corresponding ports.

<P>

<LI>a <I>level</I> that is one higher than that of its parent goal.

</UL>

<P>
The displayed variable instantiations are the ones at call time,
i.e. before the head unification of any clause.

<P>
<DT><STRONG>EXIT:</STRONG>
<DD>When a clause of a predicate succeeds (i.e. unification
succeeded and all procedures called by the clause succeeded),
the flow gets out of the box by the EXIT port of both boxes (only
the EXIT port of the <I>procedure box</I> is traced).

<P>
When a procedure exits non-deterministically (and there are still
other clauses to try on that procedure or one of its children goals
has alternatives which could be resatisfied), the EXIT port is traced
with an asterisk (*EXIT). When the last possibly matching clause of a
procedure is exited, the exit is traced without asterisk. This means
that this procedure box will never be retried as there is no other
untried alternative.

<P>
The instantiations shown in the EXIT port are the ones at exit time,
they result from the (successful) execution of the procedure.

<P>
<DT><STRONG>FAIL:</STRONG>
<DD>When a clause of a procedure fails (because head unification
failed or because a sub-goal failed), the flow of the execution exits
the clause box and leaves the procedure box via the FAIL port.
Note that the debugger cannot display any argument information at
FAIL ports (an ellipsis <code>...</code> is displayed instead for each argument).

<P>
<DT><STRONG>NEXT:</STRONG>
<DD>If a clause fails and there is another possibly
matching clause to try, then that one is tried for unification.
The flow of the execution from the failure of one clause to the
head unification of a following clause is traced as a NEXT port.
The displayed variable instantiations are the same as those of the
corresponding CALL or REDO port.

<P>
<DT><STRONG>ELSE:</STRONG>
<DD>This is similar to the NEXT port, but indicates that the next branch of a
<A NAME="tex2html1082"
 HREF="../bips/kernel/control/O-2.html">disjunction (;/2)</A><A NAME="8047"></A>
it tried after the previous branch failed.
The predicate that gets displayed with the port is the predicate
which contains the disjunction (the immediate ancestor).

<P>
<DT><STRONG>REDO:</STRONG>
<DD>When a procedure box is exited trough an *EXIT port,
the box can be retried later to get a new solution. This will happen when a
later goal fails. The backtracking will cause failing of all
procedures that do not have any alternative, then the execution flow
will enter a
procedure box that an contains alternative through a REDO port.

<P>
Two situations may occur: either the last tried clause has called a
procedure that has left a choice point (it has exited through an
*EXIT port). In that case the nested procedure box is re-entered
though another REDO-port.

<P>
Otherwise, if the last clause tried does not contain any
nondeterministically exited boxes, but there are other untried clauses
in the procedure box, the next possibly matching clause will be tried.

<P>
The last REDO port in such a sequence is the one which contains the
actual alternative that is tried. The variable instantiations for all
REDO ports in such a sequence are the ones corresponding to the call
time of the last one.

<P>
<DT><STRONG>LEAVE:</STRONG>
<DD>This port allows to trace the execution of a the
<A NAME="tex2html1084"
 HREF="../bips/kernel/control/block-3.html">block/3</A><A NAME="8050"></A> and
<A NAME="tex2html1086"
 HREF="../bips/kernel/control/exit_block-1.html">exit_block/1</A><A NAME="8053"></A>
predicates within the box model.  The predicate
<A NAME="tex2html1088"
 HREF="../bips/kernel/control/block-3.html">block/3</A><A NAME="8056"></A> is traced as
a normal procedure.  If the goal in its first argument fails,
<A NAME="tex2html1090"
 HREF="../bips/kernel/control/block-3.html">block/3</A><A NAME="8059"></A> fails, if it
exits, <A NAME="tex2html1092"
 HREF="../bips/kernel/control/block-3.html">block/3</A><A NAME="8062"></A> exits. 
If the predicate <A NAME="tex2html1094"
 HREF="../bips/kernel/control/exit_block-1.html">exit_block/1</A><A NAME="8065"></A> is called (and exited since it
never fails), all the goals inside the matching block are left through
a special port called LEAVE, so that each entry port matches with an
exit port.  The recover procedure (in the third argument of
<A NAME="tex2html1096"
 HREF="../bips/kernel/control/block-3.html">block/3</A><A NAME="8068"></A>) is then
called and traced normally and
<A NAME="tex2html1098"
 HREF="../bips/kernel/control/block-3.html">block/3</A><A NAME="8071"></A> will exit or
fail (or even leave) depending on the recover procedure.

<P>
As with the FAIL port, no argument value are displayed in the LEAVE port.

<P>
<DT><STRONG>DELAY:</STRONG>
<DD>The displayed goal becomes suspended. This is a singleton port, it does
not enter or leave a box. However, a new <I>invocation number</I> is assigned
to the delayed goal, and this number will be used in the matching RESUME port.
The DELAY port is caused by one of the built-in predicates
<A NAME="tex2html1100"
 HREF="../bips/kernel/suspensions/suspend-3.html">suspend/3</A><A NAME="8074"></A>,
<A NAME="tex2html1102"
 HREF="../bips/kernel/suspensions/suspend-4.html">suspend/4</A><A NAME="8077"></A>,
<A NAME="tex2html1104"
 HREF="../bips/kernel/suspensions/make_suspension-3.html">make_suspension/3</A><A NAME="8080"></A>
or a delay clause.
The port is displayed just after the delayed goal has been created.

<P>
<DT><STRONG>RESUME:</STRONG>
<DD>When a waking condition causes the resuming of
a delayed goal, the procedure box is entered through its RESUME
port.  The box then behaves as if it had been entered through its CALL
port.  The invocation number is the same as in its previous DELAY port.
which makes it easy to identify corresponding delay and resume events.
However the depth level of the RESUME corresponds to the waking situation.
It is traced like a subgoal of the goal which has caused the waking.

<P>
</DL>

<P>
In the rest of this chapter the user interface to the debugger is
described, including the commands available in the debugger itself as
well as built-in predicates which influence it.  Some of the debugger
commands are explained using an excerpt of a debugger session.  In
these examples, the user input is always underlined (it is in fact
not always output as typed) to distinguish it from the computer output.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html3423"
 HREF="node77.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html3419"
 HREF="node75.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html3413"
 HREF="node75.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html3421"
 HREF="node158.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html3424"
 HREF="node77.html">Format of the Tracing</A>
<B> Up:</B> <A NAME="tex2html3420"
 HREF="node75.html">Debugging</A>
<B> Previous:</B> <A NAME="tex2html3414"
 HREF="node75.html">Debugging</A>
 &nbsp <B>  <A NAME="tex2html3422"
 HREF="node158.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey</I>
<BR><I>2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
