<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Eplex Instances</TITLE>
<META NAME="description" CONTENT="Eplex Instances">
<META NAME="keywords" CONTENT="libman">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="libman.css">
<LINK REL="next" HREF="node56.html">
<LINK REL="previous" HREF="node54.html">
<LINK REL="up" HREF="node53.html">
<LINK REL="next" HREF="node56.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html1713"
 HREF="node56.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html1709"
 HREF="node53.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html1703"
 HREF="node54.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html1711"
 HREF="node71.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1714"
 HREF="node56.html">Advanced Use of Eplex</A>
<B> Up:</B> <A NAME="tex2html1710"
 HREF="node53.html">EPLEX: The ECLiPSe/LP/MIP Interface</A>
<B> Previous:</B> <A NAME="tex2html1704"
 HREF="node54.html">Usage</A>
 &nbsp <B>  <A NAME="tex2html1712"
 HREF="node71.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL>
<LI><A NAME="tex2html1715"
 HREF="node55.html#SECTION00920100000000000000">eplex_instance(+Name)</A>
</UL>
<LI><A NAME="tex2html1716"
 HREF="node55.html#SECTION00921000000000000000">Linear Constraints</A>
<UL>
<LI><A NAME="tex2html1717"
 HREF="node55.html#SECTION00921100000000000000">EplexInstance: (X $= Y)</A>
<LI><A NAME="tex2html1718"
 HREF="node55.html#SECTION00921200000000000000">EplexInstance: (X $&gt;= Y)</A>
<LI><A NAME="tex2html1719"
 HREF="node55.html#SECTION00921300000000000000">EplexInstance: (X  $=&lt; Y)</A>
</UL>
<LI><A NAME="tex2html1720"
 HREF="node55.html#SECTION00922000000000000000">Linear Expressions</A>
<LI><A NAME="tex2html1721"
 HREF="node55.html#SECTION00923000000000000000">Bounds</A>
<LI><A NAME="tex2html1722"
 HREF="node55.html#SECTION00924000000000000000">Integrality</A>
<LI><A NAME="tex2html1723"
 HREF="node55.html#SECTION00925000000000000000">Solving Simple Eplex Problems</A>
<LI><A NAME="tex2html1724"
 HREF="node55.html#SECTION00926000000000000000">Examples</A>

<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION00920000000000000000">
Eplex Instances</A>
</H1>

<P>
In this chapter, the problem passed to the external solver will be referred
to as an <I>eplex problem</I>. An eplex problem consists of a set of linear
arithmetic constraints, whose variables have bounds and may possibly have
integrality constraints. The external solver will solve such a problem by optimising
these constraints with respect to an objective function. 

<P>
With the eplex library, it is possible to have more than one eplex problem
within one program. The simplest way to write such programs with the
library is through <I>Eplex Instances</I>. An eplex instance is an instance
of the eplex solver, to which an eplex problem can be sent. An external
<I>solver state</I> can be associated with each eplex instance, which can be
invoked to solve the eplex problem. Declaratively, an eplex instance can be
seen as a compound constraint consisting of all the variables, their bounds, and
constraints of the eplex problem.

<P>
Like other solvers, each eplex instance has its own module. To use an eplex
instance, it must first be declared, so that the module can be created.
This is done by:

<P>

<H3><A NAME="SECTION00920100000000000000"></A><A NAME="4484"></A>
<BR>
<A NAME="tex2html445"
 HREF="../bips/lib/eplex/eplex_instance-1.html">eplex_instance(+Name)</A>
</H3>

<P>
This predicate will initialise an eplex instance <TT>Name</TT>. Once
initialised, a <TT>Name</TT> module will exist, to which the user can post the 
constraints for the eplex problem and setup and use the external solver
state to solve the eplex problem. Normally, this predicate should be issued
as a directive in the user's program, so that the program code can refer to
the instance directly in their code. For example:

<P>
<PRE>
   :- eplex_instance(instance).
</PRE>

<P>
For convenience, the eplex library declares <TT>eplex</TT> as an eplex instance 
when the library is loaded. 

<P>

<H2><A NAME="SECTION00921000000000000000"></A>
<A NAME="linear-constraints"></A>
<BR>
Linear Constraints
</H2>
The constraints provided are equalities and inequalities over
linear expressions.
Their operational behaviour is as follows:

<UL><LI>When they contain no variables, they simply succeed or fail.

<LI>When they contain exactly one variable, they are translated into
a bound update on that variable, which may in turn fail, succeed,
or even instantiate the variable.
Note that if the variable's type is integer, the bound will be adjusted
to the next suitable integral value.

<LI>Otherwise, the constraint is transferred to the external solver state
if the state has been setup. If it has not, the constraint
delays and is transferred to the external solver state when it is setup.
This mechanism makes it possible to interface to a non-incremental
black-box solver that requires all constraints at once,
or to send constraints to the solver in batches

</UL>

<P>
As with all predicates defined for an eplex instance, these constraints
should be module-qualified with the name of the eplex instance. In the following
they are shown qualified with the <TT>eplex</TT> instance. Other instances can
be used if they have been declared using <B>eplex_instance/1</B>.

<H3><A NAME="SECTION00921100000000000000"></A><A NAME="4487"></A>
<BR>
<A NAME="tex2html447"
 HREF="../bips/lib/eplex/SE-2.html">EplexInstance: (X $= Y)</A>
</H3>
X is equal to Y. X and Y are linear expressions.

<P>

<H3><A NAME="SECTION00921200000000000000"></A><A NAME="4490"></A>
<BR>
<A NAME="tex2html449"
 HREF="../bips/lib/eplex/SGE-2.html">EplexInstance: (X $&gt;= Y)</A>
</H3>
X is greater or equal to Y. X and Y are linear expressions.

<P>

<H3><A NAME="SECTION00921300000000000000"></A><A NAME="4493"></A>
<BR>
<A NAME="tex2html451"
 HREF="../bips/lib/eplex/SEL-2.html">EplexInstance: (X  $=&lt; Y)</A>
</H3>
X is less or equal to Y. X and Y are linear expressions.

<P>

<H2><A NAME="SECTION00922000000000000000">
Linear Expressions</A>
</H2>

<P>
The following arithmetic expression can be used inside the constraints:
<DL>
<DT><STRONG><B>X</B></STRONG>
<DD>Variables. If X is not yet a problem variable, it is turned into one
	via an implicit declaration <TT>X $:: -1.0Inf..1.0Inf</TT>.

<P>
<DT><STRONG><B>123, 3.4</B></STRONG>
<DD>Integer or floating point constants.

<P>
<DT><STRONG><B>+</B>Expr</STRONG>
<DD>Identity.

<P>
<DT><STRONG><B>-</B>Expr</STRONG>
<DD>Sign change.

<P>
<DT><STRONG>E1<B>+</B>E2</STRONG>
<DD>Addition.

<P>
<DT><STRONG><B>sum</B>(ListOfExpr)</STRONG>
<DD>Equivalent to the sum of all list elements.

<P>
<DT><STRONG>E1<B>-</B>E2</STRONG>
<DD>Subtraction.

<P>
<DT><STRONG>E1<B>*</B>E2</STRONG>
<DD>Multiplication.

<P>
<DT><STRONG>ListOfExpr1<B>*</B>ListOfExpr2</STRONG>
<DD>Scalar product: The sum of the products of the corresponding
elements in the two lists.  The lists must be of equal length.
</DL>

<P>

<H2><A NAME="SECTION00923000000000000000">
Bounds</A>
</H2>
Bounds for variables can be given to an eplex instance via the <code>$::/2</code>
constraint:
<DL>
<DT><STRONG><A NAME="tex2html453"
 HREF="../bips/lib/eplex/SNN-2.html">EplexIntance: Vars $:: Lo..Hi</A><A NAME="4496"></A></STRONG>
<DD><A NAME="eplex-coloncolon2"></A>    Restrict the external solver to assign solution values for the eplex
    problem within the bounds specified by Lo..Hi.  
    Passes to the external solver the bounds for the variables in Vars.
    Lo, Hi are the lower and upper bounds, respectively. Note that the
    bounds are only passed to the external solver if they would narrow the
    current bounds, and failure will occur if the resulting interval is empty. 
    Note also that the external solver does not do any bound propagation
    and will thus not change the bounds on its own. The default bounds for
    variables are notionally -1.0Inf..1.0Inf (where infinity is actually
    defined as the solver's notion of infinity).
</DL>

<P>

<H2><A NAME="SECTION00924000000000000000">
Integrality</A>
</H2>
The difference between using an LP vs. an MIP solver is made by
declaring integrality to the solver via the integers/1 constraint:
<DL>
<DT><STRONG><A NAME="tex2html455"
 HREF="../bips/lib/eplex/integers-1.html">EplexInstance:integers(Vars)</A><A NAME="4499"></A></STRONG>
<DD><A NAME="eplex-integers1"></A>	Inform the external solver to treat the variables Vars as integral.
	It does not impose the integer type on Vars. However, when a 
        typed_solution is retrieved (via lp_get/3 or
        lp_var_get/3), this will be rounded to the nearest integer.
        
        Note that unless eplex:integers/1 (or lp_add/3, see
        section&nbsp;<A HREF="node57.html#lp-add">9.4.2</A>) is invoked, any invocation
        of the eplex external solver (via lp_solve/2, lp_probe/3 or
	lp_demon_setup/5) will only solve a continuous relaxation, even
        when problem variables have been declared as integers in other
        solvers (e.g. ic).
        
</DL>

<P>
Note that all the above constraints are local to the eplex instance; they
do not place any restrictions on the variables for other eplex instances or
solvers. Failure will occur only when inconsistency is detected within the
same eplex instance, unless the user explicitly try to merge the constraints
from different solvers/eplex instance.

<P>

<H2><A NAME="SECTION00925000000000000000"></A>
<A NAME="solving-eplex"></A>
<BR>
Solving Simple Eplex Problems
</H2>
In order to solve an eplex problem, the eplex instance must be set up
for an external solver state. The solver state can then be invoked to
solve the problem. The simplest way to do this is to use:

<P>
<DL>
<DT><STRONG><A NAME="tex2html457"
 HREF="../bips/lib/eplex/eplex_solver_setup-1.html">EplexInstance:eplex_solver_setup(+Objective)</A><A NAME="4502"></A></STRONG>
<DD>This predicate creates a new external solver state and associates it
    with the eplex instance. Any arithmetic, integrality and bound
    constraints posted for this eplex instance are collected to create the
    external solver state. After this, the solver state can be invoked to 
    solve the eplex problem.

<P>
Objective is either min(Expr) or max(Expr) where Expr is a linear
    expression (or quadratic, if supported by the external solver).  

<P>
<DT><STRONG><A NAME="tex2html459"
 HREF="../bips/lib/eplex/eplex_solve-1.html">EplexInstance:eplex_solve(-Cost)</A><A NAME="4505"></A></STRONG>
<DD>Explicitly invokes the external solver state. Any new constraints
    posted are taken into account. If the external solver can find an
    optimal solution to the eplex problem, then the predicate succeeds and Cost is
    instantiated to the optimal value. If the problem is infeasible (has no
    solution) or unbounded (Cost is not bounded by the constraints), then 
    the predicate fails. 

<P>
</DL>
<H2><A NAME="SECTION00926000000000000000">
Examples</A>
</H2>

<P>
Here is a simple linear program, handled by the predefined eplex instance 'eplex':
<PRE>
:- lib(eplex).

lp_example(Cost) :-
     eplex: eplex_solver_setup(min(X)),
     eplex: (X+Y $&gt;= 3),
     eplex: (X-Y $= 0),
     eplex: eplex_solve(Cost).
</PRE>

<P>
The same example using a user-defined eplex instance:
<PRE>
:- lib(eplex).
:- eplex_instance(my_instance).

lp_example(Cost) :-
     my_instance: eplex_solver_setup(min(X)),
     my_instance: (X+Y $&gt;= 3),
     my_instance: (X-Y $= 0),
     my_instance: eplex_solve(Cost).
</PRE>

<P>
Running the program gives the optimal value for Cost:

<P>
<PRE>
[eclipse 2]: lp_example(Cost).

Cost = 1.5
</PRE>

<P>
Note that if the <TT>eplex</TT> eplex instance is used instead of <TT>my_instance</TT>, then the <TT>eplex_instance/1</TT> declaration is not
necessary.

<P>
By declaring one variable as integer, we obtain a Mixed Integer Problem:

<P>
<PRE>
:- lib(eplex).
:- eplex_instance(my_instance).

mip_example(Cost) :-
     my_instance: (X+Y $&gt;= 3),
     my_instance: (X-Y $= 0),
     my_instance: integers([X]),
     my_instance: eplex_solver_setup(min(X)),
     my_instance: eplex_solve(Cost).

....
[eclipse 2]: mip_example(Cost).

Cost = 2.0
</PRE>

<P>
The cost is now higher because X is constrained to be an integer. Note also
that in this example, we posted the constraints before setting up the 
external solver, whereas in the previous example we set up the solver
first. The solver set up and constraint posting can be done in
any order. If <TT>integers/1</TT> constraints are only posted after problem
setup, the problem will be automatically converted from an LP to a MIP
problem. 

<P>
This section has introduced the most basic ways to use the eplex library. 
We will discuss more advanced methods of using the eplex instances in
section&nbsp;<A HREF="node56.html#eplex-instance-advanced">9.3</A>. 

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html1713"
 HREF="node56.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html1709"
 HREF="node53.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html1703"
 HREF="node54.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html1711"
 HREF="node71.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html1714"
 HREF="node56.html">Advanced Use of Eplex</A>
<B> Up:</B> <A NAME="tex2html1710"
 HREF="node53.html">EPLEX: The ECLiPSe/LP/MIP Interface</A>
<B> Previous:</B> <A NAME="tex2html1704"
 HREF="node54.html">Usage</A>
 &nbsp <B>  <A NAME="tex2html1712"
 HREF="node71.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey <BR>
2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
