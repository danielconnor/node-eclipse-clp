<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.2 beta5 (July 28th, 1998)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Examples</TITLE>
<META NAME="description" CONTENT="Examples">
<META NAME="keywords" CONTENT="obsman">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="obsman.css">
<LINK REL="next" HREF="node15.html">
<LINK REL="previous" HREF="node13.html">
<LINK REL="up" HREF="node2.html">
<LINK REL="next" HREF="node15.html">
</HEAD>
<BODY >
<!--Navigation Panel-->
<A NAME="tex2html557"
 HREF="node15.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html553"
 HREF="node2.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html547"
 HREF="node13.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html555"
 HREF="node34.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html558"
 HREF="node15.html">General Guidelines to the</A>
<B> Up:</B> <A NAME="tex2html554"
 HREF="node2.html">The Finite Domains Library</A>
<B> Previous:</B> <A NAME="tex2html548"
 HREF="node13.html">Debugger Support</A>
 &nbsp <B>  <A NAME="tex2html556"
 HREF="node34.html">Index</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION002120000000000000000">
Examples</A>
</H1>
A very simple example of using the finite domains is the <I>send
more money</I> puzzle:<PRE>
:- use_module(library(fd)).

send(List) :-
    List = [S, E, N, D, M, O, R, Y],
    List :: 0..9,
    alldifferent(List),
    1000*S+100*E+10*N+D + 1000*M+100*O+10*R+E #=
        10000*M+1000*O+100*N+10*E+Y,
    M #\= 0,
    S #\= 0,
    labeling(List).
</PRE>

<P>
The problem is stated very simply, one just writes down the conditions
that must hold for the involved variables and then uses the default
<I>labeling</I> procedure, i.e. the order in which the variables
<A NAME="680"></A>
will be instantiated.
When executing <B>send/1</B>, the variables <I>S</I>, <I>M</I>
and <I>O</I> are instantiated even before the labeling
procedure starts.
When a consistent value for the variable <I>E</I> is found (5),
and this value is propagated to the other variables, all
variables become instantiated and thus the rest of the labeling
procedure only checks groundness of the list.

<P>
A slightly more elaborate example is the <I>eight queens</I>
puzzle.
Let us show a solution for this problem generalised to N queens
and also enhanced by a cost function that evaluates
every solution.
The cost can be for example
<I><I>col</I><SUB><I>i</I></SUB> - <I>row</I><SUB><I>i</I></SUB></I>
for the i-th queen.
We are now looking for the solution with the smallest cost,
i.e. one for which the maximum of all
<I><I>col</I><SUB><I>i</I></SUB> - <I>row</I><SUB><I>i</I></SUB></I>
`_=
is minimal:

<P><PRE>
:- use_module(library(fd)).

% Find the minimal solution for the N-queens problem
cqueens(N, List) :-
    make_list(N, List),
    List :: 1..N,
    constrain_queens(List),
    make_cost(1, List, C),
    min_max(labeling(List), C).

% Set up the constraints for the queens
constrain_queens([]).
constrain_queens([X|Y]) :-
    safe(X, Y, 1),
    constrain_queens(Y).

safe(_, [], _).
safe(X, [Y|T], K) :-
    noattack(X, Y, K) ,
    K1 is K + 1 ,
    safe(X, T, K1).

% Queens in rows X and Y cannot attack each other
noattack(X, Y, K) :-
    X #\= Y,
    X + K #\= Y,
    X - K #\= Y.

% Create a list with N variables
make_list(0, []) :- !.
make_list(N, [_|Rest]) :-
    N1 is N - 1,
    make_list(N1, Rest).

% Set up the cost expression
make_cost(_, [], []).
make_cost(N, [Var|L], [N-Var|Term]) :-
    N1 is N + 1,
    make_cost(N1, L, Term).

labeling([]) :- !.
labeling(L) :-
    deleteff(Var, L, Rest),
    indomain(Var),
    labeling(Rest).
</PRE>

<P>
The approach is similar to the previous example: first we create
the domain variables, one for each column of the board,
whose values will be the rows.
We state constraints which must hold between every pair
of queens and finally
we make the cost term in the format required for the
<A NAME="tex2html139"
 HREF="../bips/lib/fd/min_max-2.html">min_max/2</A><A NAME="1259"></A> predicate.
The labeling predicate selects the most constrained variable
for instantiation using the <A NAME="tex2html141"
 HREF="../bips/lib/fd/deleteff-3.html">deleteff/3</A><A NAME="1262"></A> predicate.
When running the example, we get the following result:<PRE>
[eclipse 19]: cqueens(8, X).
Found a solution with cost 5
Found a solution with cost 4

X = [5, 3, 1, 7, 2, 8, 6, 4] 
yes.
</PRE>
The time needed to find the minimal solution is about five times
shorter than the time to generate all solutions.
This shows the advantage of the <I>branch and bound</I> method.
Note also that the board for this `minimal' solution looks
very nice.

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html557"
 HREF="node15.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html553"
 HREF="node2.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html547"
 HREF="node13.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>  
<A NAME="tex2html555"
 HREF="node34.html">
<IMG WIDTH="43" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="index" SRC="index_motif.gif"></A> 
<BR>
<B> Next:</B> <A NAME="tex2html558"
 HREF="node15.html">General Guidelines to the</A>
<B> Up:</B> <A NAME="tex2html554"
 HREF="node2.html">The Finite Domains Library</A>
<B> Previous:</B> <A NAME="tex2html548"
 HREF="node13.html">Debugger Support</A>
 &nbsp <B>  <A NAME="tex2html556"
 HREF="node34.html">Index</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
<I>Warwick Harvey <BR>
2005-01-25</I>
</ADDRESS>
</BODY>
</HTML>
